{"remainingRequest":"D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\src\\components\\ListeDesRestaurants.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\src\\components\\ListeDesRestaurants.vue","mtime":1635497968000},{"path":"D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\UCA\\TechnosWeb\\Mini Projet M1 Miage 2021-2022 Technologies Web\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gImxvZGFzaCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTGlzdGVEZXNSZXN0YXVyYW50cyIsCiAgZGF0YTogKCkgPT4gewogICAgcmV0dXJuIHsKICAgICAgcmVzdGF1cmFudHMgOiBbXSwKICAgICAgbm9tOiAiIiwKICAgICAgY3Vpc2luZTogIiIsCiAgICAgIGJvcm91Z2ggOiAiIiwKICAgICAgbm9tYnJlUmVzdGF1cmFudHNUb3RhbDogMCwKICAgICAgcGFnZTogMCwKICAgICAgcGFnZVNpemU6IDEwLAogICAgICBuYnJlUGFnZXNUb3RhbDogMCwKICAgICAgbXNnOiAiIiwKICAgICAgbm9tUmVzdG9SZWNoZXJjaGVyOiAiIiwKICAgICAgbm90Rm91bmQ6IGZhbHNlLAogICAgICByZXN0b01vZGFsIDogZmFsc2UsCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0UmVzdGF1cmFudHNGcm9tU2VydmVyKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBwYWdlUHJlY2VkZW50ZSgpIHsKICAgICAgaWYgKHRoaXMucGFnZSA9PSAwKSByZXR1cm47CgogICAgICB0aGlzLnBhZ2UtLTsKICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsKICAgIH0sCiAgICBwYWdlU3VpdmFudGUoKSB7CiAgICAgIGlmICh0aGlzLnBhZ2UgPT09IHRoaXMuZGVybmllcmVQYWdlKSByZXR1cm47CiAgICAgIHRoaXMucGFnZSsrOwogICAgICB0aGlzLmdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpOwogICAgfSwKICAgIGdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpIHsKICAgICAgbGV0IHVybCA9ICJodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL3Jlc3RhdXJhbnRzPyI7CiAgICAgIHVybCArPSAicGFnZT0iICsgdGhpcy5wYWdlOwogICAgICB1cmwgKz0gIiZwYWdlc2l6ZT0iICsgdGhpcy5wYWdlU2l6ZTsKICAgICAgdXJsICs9ICImbmFtZT0iICsgdGhpcy5ub21SZXN0b1JlY2hlcmNoZXI7CgogICAgICBmZXRjaCh1cmwpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlSlNPTikgPT4gewogICAgICAgICAgLy9hcm93IGZvbmN0aW9uIGNvbnNlcnZlIGxlIGJvbiAidGhpcyIuCiAgICAgICAgICByZXNwb25zZUpTT04uanNvbigpLnRoZW4oKHJlc0pzKSA9PiB7CiAgICAgICAgICAgIC8vIE1haW50ZW5hbnQgcmVzSnMgZXN0IHVuIHZyYWkgb2JqZXQgSmF2YVNjcmlwdAogICAgICAgICAgICB0aGlzLnJlc3RhdXJhbnRzID0gcmVzSnMuZGF0YTsKICAgICAgICAgICAgY29uc29sZS5kaXIodGhpcy5yZXN0YXVyYW50cyk7CiAgICAgICAgICAgIHRoaXMubm9tYnJlUmVzdGF1cmFudHNUb3RhbCA9IHJlc0pzLmNvdW50OwogICAgICAgICAgICB0aGlzLm5icmVQYWdlc1RvdGFsID0gTWF0aC5yb3VuZCgKICAgICAgICAgICAgICB0aGlzLm5vbWJyZVJlc3RhdXJhbnRzVG90YWwgLyB0aGlzLnBhZ2VTaXplCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmICh0aGlzLm5vbWJyZVJlc3RhdXJhbnRzVG90YWwgPD0gMCkgewogICAgICAgICAgICAgIHRoaXMubm90Rm91bmQgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMubm90Rm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBjaGVyY2hlclJlc3RvOiBfLmRlYm91bmNlKGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsKCiAgICAgIC8vIHRoaXMuZ2V0UmVzdGF1cmFudHNGcm9tU2VydmVyKCk7CiAgICB9LCAxMDAwKSwKICAgIHN1cHByaW1lclJlc3RhdXJhbnQocikgewogICAgICBsZXQgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHMvIiArIHIuX2lkOwoKICAgICAgZmV0Y2godXJsLCB7CiAgICAgICAgbWV0aG9kOiAiREVMRVRFIiwKICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2VKU09OKSA9PiB7CiAgICAgICAgICByZXNwb25zZUpTT04uanNvbigpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAvLyBNYWludGVuYW50IHJlcyBlc3QgdW4gdnJhaSBvYmpldCBKYXZhU2NyaXB0CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5tc2cpOwogICAgICAgICAgICB0aGlzLm1zZyA9IHJlcy5tc2c7CgogICAgICAgICAgICAvL09uIHJhZmZyYWljaGl0IGxhIHZ1ZQogICAgICAgICAgICB0aGlzLmdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpOwogICAgICAgICAgfSk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBham91dGVyUmVzdGF1cmFudChldmVudCkgewogICAgICAvLyBSw6ljdXDDqXJhdGlvbiBkdSBmb3JtdWxhaXJlLiBQYXMgYmVzb2luIGRlIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IKICAgICAgLy8gb3UgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQgcHVpc3F1ZSBjJ2VzdCBsZSBmb3JtdWxhaXJlIHF1aSBhIGfDqW7DqXLDqQogICAgICAvLyBsJ8OpdsOpbmVtZW50CiAgICAgIGxldCBmb3JtID0gZXZlbnQudGFyZ2V0OwoKICAgICAgLy8gUsOpY3Vww6lyYXRpb24gZGVzIHZhbGV1cnMgZGVzIGNoYW1wcyBkdSBmb3JtdWxhaXJlCiAgICAgIC8vIGVuIHByw6l2aXNpb24gZCd1biBlbnZvaSBtdWx0aXBhcnQgZW4gYWpheC9mZXRjaAogICAgICBsZXQgZG9ubmVlc0Zvcm11bGFpcmUgPSBuZXcgRm9ybURhdGEoZm9ybSk7CgogICAgICBsZXQgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHMiOwoKICAgICAgZmV0Y2godXJsLCB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgYm9keTogZG9ubmVlc0Zvcm11bGFpcmUsCiAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlSlNPTikgPT4gewogICAgICAgICAgcmVzcG9uc2VKU09OLmpzb24oKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgLy8gTWFpbnRlbmFudCByZXMgZXN0IHVuIHZyYWkgb2JqZXQgSmF2YVNjcmlwdAogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMubXNnKTsKICAgICAgICAgICAgdGhpcy5tc2cgPSByZXMubXNnOwoKICAgICAgICAgICAgLy9PbiByYWZmcmFpY2hpdCBsYSB2dWUKICAgICAgICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgfSk7CiAgICAgIHRoaXMubm9tID0gIiI7CiAgICAgIHRoaXMuY3Vpc2luZSA9ICIiOwogICAgICB0aGlzLmJvcm91Z2ggPSAiIjsKCiAgICB9LAogICAgZ2V0Q29sb3IoaW5kZXgpIHsKICAgICAgcmV0dXJuIGluZGV4ICUgMiA/ICJsaWdodEJsdWUiIDogInBpbmsiOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["ListeDesRestaurants.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"ListeDesRestaurants.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n\n    <md-toolbar>\n      <md-list class=\"infosResto\">\n      <md-list-item>\n        <md-icon>dinner_dining</md-icon>\n        <span class=\"md-list-item-text\"><b>Nombre de restaurants par page :  </b></span>\n        <p><input type=\"range\" min=2 max=100 value=10 \n        @change=\"getRestaurantsFromServer()\" v-model=\"pageSize\">{{pageSize}}</p>\n      </md-list-item>\n      <md-list-item>\n        <md-icon><span class=\"material-icons\">restaurant</span></md-icon>\n        <span class=\"md-list-item-text\"><b>Nombre de restaurants: </b></span>\n        <p>{{ nombreRestaurantsTotal }}</p>\n      </md-list-item>\n      <md-list-item>\n         <md-icon>pages</md-icon>\n        <span class=\"md-list-item-text\"><b>Nombre de Pages Total :  </b></span>\n        <p>{{ nbrePagesTotal }}</p>\n      </md-list-item>\n      </md-list>\n    </md-toolbar>\n    <br />\n      <md-table \n        class=\"table-md\"\n        v-model=\"restaurants\"\n        md-sort=\"name\"\n        md-sort-order=\"asc\"\n        md-card>\n        <md-table-toolbar>\n          <div class=\"md-toolbar-section-start\">\n            <md-button class=\"md-raised md-primary\" @click=\"restoModal=true\">\n              <md-icon><span class=\"material-icons\">add</span></md-icon>Ajouter un nouveau restaurant\n            </md-button>\n            <md-dialog :md-active.sync=\"restoModal\">\n              <md-dialog-title>Ajout d'un nouveau restaurant</md-dialog-title>\n              \n              <form @submit.prevent=\"ajouterRestaurant($event)\">\n\n                <md-dialog-content>\n                    <md-field>\n                      <label>Nom</label>\n                      <md-input v-model=\"nom\" name=\"nom\" required></md-input>\n                    </md-field>\n                    <md-field>\n                      <label>Cuisine</label>\n                      <md-input v-model=\"cuisine\" name=\"cuisine\" required></md-input>\n                    </md-field>\n                    <md-field>\n                      <label>Ville</label>\n                      <md-input v-model=\"borough\" name=\"borough\"></md-input>\n                    </md-field>\n                </md-dialog-content>\n\n                <md-dialog-actions>\n                  <md-button class=\"md-primary\" @click=\"restoModal= false\">Close</md-button>\n                  <md-button type=\"submit\" class=\"md-primary\">Ajouter</md-button>\n                </md-dialog-actions>\n              </form>\n\n            </md-dialog>\n          </div>\n\n          <md-field  class=\"md-toolbar-section-end\">\n              <md-input @input=\"chercherResto()\" v-model=\"nomRestoRechercher\" placeholder=\"Chercher par nom:\">\n              </md-input>\n          </md-field>\n        </md-table-toolbar>\n\n        <md-table-empty-state\n        md-label=\"Aucun restaurant trouvé\"\n        :md-description=\"`Aucun restaurant ne correspond à votre recherche!`\">\n        </md-table-empty-state>\n\n        <md-table-row \n          :style=\"{ backgroundColor: getColor(index) }\"\n          :class=\"{ bordureRouge: index === 2 }\"\n          slot=\"md-table-row\"\n          slot-scope=\"{ item, index }\"\n        >\n          \n          <md-table-cell md-label=\"Name\" md-sort-by=\"name\">{{ item.name }}</md-table-cell>\n          <md-table-cell md-label=\"Cuisine\" md-sort-by=\"cuisine\">{{item.cuisine}}</md-table-cell>\n          <md-table-cell md-label=\"Ville\" md-sort-by=\"cuisine\">{{item.borough}}</md-table-cell>\n          <md-table-cell md-label=\"Action\">\n            <router-link :to=\"'/restaurant/' + item._id\"><button class=\"md-accent\"><md-icon>read_more</md-icon></button>\n            </router-link>\n          </md-table-cell>\n        </md-table-row>\n      </md-table>\n      <md-toolbar>\n        <div class=\"md-toolbar-section-start\">\n        \n        </div>\n        <div  class=\"md-toolbar-section-end\">\n          <md-button :disabled=\"page === 0\" @click=\"pagePrecedente()\"\n          >Précédente\n          </md-button\n            >&nbsp;&nbsp;\n          <md-button :disabled=\"page === nbrePagesTotal\" @click=\"pageSuivante()\"\n          >Suivante</md-button>\n        </div>\n      </md-toolbar>\n      \n  </div>\n</template>\n\n\n<script>\nimport _ from \"lodash\";\nexport default {\n  name: \"ListeDesRestaurants\",\n  data: () => {\n    return {\n      restaurants : [],\n      nom: \"\",\n      cuisine: \"\",\n      borough : \"\",\n      nombreRestaurantsTotal: 0,\n      page: 0,\n      pageSize: 10,\n      nbrePagesTotal: 0,\n      msg: \"\",\n      nomRestoRechercher: \"\",\n      notFound: false,\n      restoModal : false,\n    };\n  },\n  mounted() {\n    this.getRestaurantsFromServer();\n  },\n  methods: {\n    pagePrecedente() {\n      if (this.page == 0) return;\n\n      this.page--;\n      this.getRestaurantsFromServer();\n    },\n    pageSuivante() {\n      if (this.page === this.dernierePage) return;\n      this.page++;\n      this.getRestaurantsFromServer();\n    },\n    getRestaurantsFromServer() {\n      let url = \"http://localhost:8080/api/restaurants?\";\n      url += \"page=\" + this.page;\n      url += \"&pagesize=\" + this.pageSize;\n      url += \"&name=\" + this.nomRestoRechercher;\n\n      fetch(url)\n        .then((responseJSON) => {\n          //arow fonction conserve le bon \"this\".\n          responseJSON.json().then((resJs) => {\n            // Maintenant resJs est un vrai objet JavaScript\n            this.restaurants = resJs.data;\n            console.dir(this.restaurants);\n            this.nombreRestaurantsTotal = resJs.count;\n            this.nbrePagesTotal = Math.round(\n              this.nombreRestaurantsTotal / this.pageSize\n            );\n            if (this.nombreRestaurantsTotal <= 0) {\n              this.notFound = true;\n            } else {\n              this.notFound = false;\n            }\n          });\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    chercherResto: _.debounce(function () {\n      this.getRestaurantsFromServer();\n\n      // this.getRestaurantsFromServer();\n    }, 1000),\n    supprimerRestaurant(r) {\n      let url = \"http://localhost:8080/api/restaurants/\" + r._id;\n\n      fetch(url, {\n        method: \"DELETE\",\n      })\n        .then((responseJSON) => {\n          responseJSON.json().then((res) => {\n            // Maintenant res est un vrai objet JavaScript\n            console.log(res.msg);\n            this.msg = res.msg;\n\n            //On raffraichit la vue\n            this.getRestaurantsFromServer();\n          });\n        })\n        .catch(function (err) {\n          console.log(err);\n        });\n    },\n    ajouterRestaurant(event) {\n      // Récupération du formulaire. Pas besoin de document.querySelector\n      // ou document.getElementById puisque c'est le formulaire qui a généré\n      // l'événement\n      let form = event.target;\n\n      // Récupération des valeurs des champs du formulaire\n      // en prévision d'un envoi multipart en ajax/fetch\n      let donneesFormulaire = new FormData(form);\n\n      let url = \"http://localhost:8080/api/restaurants\";\n\n      fetch(url, {\n        method: \"POST\",\n        body: donneesFormulaire,\n      })\n        .then((responseJSON) => {\n          responseJSON.json().then((res) => {\n            // Maintenant res est un vrai objet JavaScript\n            console.log(res.msg);\n            this.msg = res.msg;\n\n            //On raffraichit la vue\n            this.getRestaurantsFromServer();\n          });\n        })\n        .catch(function (err) {\n          console.log(err);\n        });\n      this.nom = \"\";\n      this.cuisine = \"\";\n      this.borough = \"\";\n\n    },\n    getColor(index) {\n      return index % 2 ? \"lightBlue\" : \"pink\";\n    },\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh1 {\n  color: blue;\n}\n.table-md {\n  display: flex;\n}\nul.md-list.infosResto {\n    display: contents;\n}\nul.md-list.infosResto b {\n    font-size: 13px;\n}\n\n</style>\n"]}]}