{"remainingRequest":"D:\\UCA\\TechnosWeb\\tp3\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\UCA\\TechnosWeb\\tp3\\src\\components\\ListeDesRestaurants.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\UCA\\TechnosWeb\\tp3\\src\\components\\ListeDesRestaurants.vue","mtime":1634751323880},{"path":"D:\\UCA\\TechnosWeb\\tp3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\UCA\\TechnosWeb\\tp3\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\UCA\\TechnosWeb\\tp3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\UCA\\TechnosWeb\\tp3\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgXyBmcm9tICJsb2Rhc2giOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnTGlzdGVEZXNSZXN0YXVyYW50cycsDQogIGRhdGE6IGZ1bmN0aW9uKCl7DQogICAgICByZXR1cm4gew0KICAgICAgICAgICAgcmVzdGF1cmFudHM6IFtdLA0KICAgICAgICAgICAgbm9tOiAnJywNCiAgICAgICAgICAgIGN1aXNpbmU6ICcnLA0KICAgICAgICAgICAgbm9tYnJlUmVzdGF1cmFudHNUb3RhbDogMCwNCiAgICAgICAgICAgIHBhZ2U6IDAsDQogICAgICAgICAgICBwYWdlU2l6ZTogMTAsDQogICAgICAgICAgICBuYnJlUGFnZXNUb3RhbDogMCwNCiAgICAgICAgICAgIG1zZzogJycsDQogICAgICAgICAgICBub21SZXN0b1JlY2hlcmNoZXI6ICcnDQogICAgICAgIH0NCiAgICB9LA0KICAgICAgICBtb3VudGVkKCkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coIm1vdW50ZWQiKQ0KICAgICAgICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsNCiAgICAgICAgfQ0KICAgICAgICAsDQogICAgICAgIG1ldGhvZHM6IHsNCiAgICAgICAgICAgIHBhZ2VQcmVjZWRlbnRlKCkgew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhZ2UgPT0gMCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgdGhpcy5wYWdlLS07DQogICAgICAgICAgICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBwYWdlU3VpdmFudGUoKSB7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMucGFnZSA9PT0gdGhpcy5kZXJuaWVyZVBhZ2UpIHJldHVybjsNCiAgICAgICAgICAgICAgICB0aGlzLnBhZ2UrKzsNCiAgICAgICAgICAgICAgICB0aGlzLmdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpIHsNCiAgICAgICAgICAgICAgICBsZXQgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHM/IjsNCiAgICAgICAgICAgICAgICB1cmwgKz0gInBhZ2U9IiArIHRoaXMucGFnZTsNCiAgICAgICAgICAgICAgICB1cmwgKz0gIiZwYWdlc2l6ZT0iICsgdGhpcy5wYWdlU2l6ZTsNCiAgICAgICAgICAgICAgICB1cmwgKz0gIiZuYW1lPSIgKyB0aGlzLm5vbVJlc3RvUmVjaGVyY2hlcjsNCg0KICAgICAgICAgICAgICAgIGZldGNoKHVybCkNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlSlNPTikgPT4gey8vYXJvdyBmb25jdGlvbiBjb25zZXJ2ZSBsZSBib24gInRoaXMiLg0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VKU09OLmpzb24oKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNKcykgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWludGVuYW50IHJlc0pzIGVzdCB1biB2cmFpIG9iamV0IEphdmFTY3JpcHQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN0YXVyYW50cyA9IHJlc0pzLmRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXN0YXVyYW50cyByw6ljdXDDqXLDqXMiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRpcih0aGlzLnJlc3RhdXJhbnRzKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub21icmVSZXN0YXVyYW50c1RvdGFsID0gcmVzSnMuY291bnQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmJyZVBhZ2VzVG90YWwgPSBNYXRoLnJvdW5kKHRoaXMubm9tYnJlUmVzdGF1cmFudHNUb3RhbCAvIHRoaXMucGFnZVNpemUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY2hlcmNoZXJSZXN0bzoNCiAgICAgICAgICAgICAgICBfLmRlYm91bmNlKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsNCiAgICAgICAgICAgICAgICB9LCAxMDAwKSwNCiAgICAgICAgICAgIHN1cHByaW1lclJlc3RhdXJhbnQocikgew0KICAgICAgICAgICAgICAgIGxldCB1cmwgPSAiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaS9yZXN0YXVyYW50cy8iICsgci5faWQ7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgZmV0Y2godXJsLCB7DQogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogIkRFTEVURSIsDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZUpTT04pID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlSlNPTi5qc29uKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1haW50ZW5hbnQgcmVzIGVzdCB1biB2cmFpIG9iamV0IEphdmFTY3JpcHQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLm1zZyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXNnID0gcmVzLm1zZzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL09uIHJhZmZyYWljaGl0IGxhIHZ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgYWpvdXRlclJlc3RhdXJhbnQoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICAvLyBSw6ljdXDDqXJhdGlvbiBkdSBmb3JtdWxhaXJlLiBQYXMgYmVzb2luIGRlIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3INCiAgICAgICAgICAgICAgICAvLyBvdSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCBwdWlzcXVlIGMnZXN0IGxlIGZvcm11bGFpcmUgcXVpIGEgZ8OpbsOpcsOpDQogICAgICAgICAgICAgICAgLy8gbCfDqXbDqW5lbWVudA0KICAgICAgICAgICAgICAgIGxldCBmb3JtID0gZXZlbnQudGFyZ2V0Ow0KDQogICAgICAgICAgICAgICAgLy8gUsOpY3Vww6lyYXRpb24gZGVzIHZhbGV1cnMgZGVzIGNoYW1wcyBkdSBmb3JtdWxhaXJlDQogICAgICAgICAgICAgICAgLy8gZW4gcHLDqXZpc2lvbiBkJ3VuIGVudm9pIG11bHRpcGFydCBlbiBhamF4L2ZldGNoDQogICAgICAgICAgICAgICAgbGV0IGRvbm5lZXNGb3JtdWxhaXJlID0gbmV3IEZvcm1EYXRhKGZvcm0pOw0KDQogICAgICAgICAgICAgICAgbGV0IHVybCA9ICJodHRwOi8vbG9jYWxob3N0OjgwODAvYXBpL3Jlc3RhdXJhbnRzIjsNCg0KICAgICAgICAgICAgICAgIGZldGNoKHVybCwgew0KICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICAgICAgICAgICAgICAgICAgYm9keTogZG9ubmVlc0Zvcm11bGFpcmUNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2VKU09OKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZUpTT04uanNvbigpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWludGVuYW50IHJlcyBlc3QgdW4gdnJhaSBvYmpldCBKYXZhU2NyaXB0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5tc2cpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZyA9IHJlcy5tc2c7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9PbiByYWZmcmFpY2hpdCBsYSB2dWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHRoaXMubm9tID0gIiI7DQogICAgICAgICAgICAgICAgdGhpcy5jdWlzaW5lID0gIiI7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZ2V0Q29sb3IoaW5kZXgpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gKGluZGV4ICUgMikgPyAnbGlnaHRCbHVlJyA6ICdwaW5rJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KfQ0K"},{"version":3,"sources":["ListeDesRestaurants.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ListeDesRestaurants.vue","sourceRoot":"src/components","sourcesContent":["\r\n<template>\r\n  <div >\r\n    <h2>{{msg}}</h2>\r\n      <form @submit.prevent=\"ajouterRestaurant($event)\">\r\n        <label>\r\n            Nom : <input type=\"text\" name=\"nom\" required v-model=\"nom\">\r\n        </label>\r\n        <label>\r\n            Cuisine : <input type=\"text\" name=\"cuisine\" required v-model=\"cuisine\">\r\n        </label>\r\n\r\n        <button>Ajouter</button>\r\n    </form>\r\n\r\n    <h1>Nombre de restaurants : {{nombreRestaurantsTotal}}</h1>\r\n    <p>Chercher par nom: \r\n        <input @input=\"chercherResto()\"  type=\"text\" v-model=\"nomRestoRechercher\">\r\n    </p>\r\n    <p>Nombre de Pages Total : {{nbrePagesTotal}}</p>\r\n    \r\n    <p>Nombre de restaurants par page: \r\n        <input \r\n        @change=\"getRestaurantsFromServer()\"\r\n        type=\"range\" min=2 max=100 value=10 v-model=\"pageSize\">\r\n        {{pageSize}}</p>\r\n    <md-button :disabled=\"page===0\" @click=\"pagePrecedente()\">Précédente</md-button>&nbsp;&nbsp;\r\n    <md-button :disabled=\"page===nbrePagesTotal\" @click=\"pageSuivante()\">Suivante</md-button>\r\n    <br>\r\n    <md-table v-model=\"restaurants\" md-sort=\"name\" md-sort-order=\"asc\" md-card>\r\n        <md-table-toolbar>\r\n        <h1 class=\"md-title\">Restaurants</h1>\r\n      </md-table-toolbar>\r\n\r\n      <md-table-row\r\n       \r\n       :style=\"{backgroundColor:getColor(index)}\" \r\n        :class=\"{bordureRouge:(index === 2)}\"\r\n                 slot=\"md-table-row\" slot-scope=\"{ item,index }\" >\r\n        <md-table-cell md-label=\"Name\" md-sort-by=\"name\"> {{ item.name }}</md-table-cell>\r\n        <md-table-cell md-label=\"Cuisine\" md-sort-by=\"cuisine\">{{ item.cuisine }}</md-table-cell>\r\n        <md-table-cell md-label=\"Action\" > \r\n<router-link :to=\" '/restaurant/' + item._id\">[Détail d'un Restaurant]\r\n        </router-link>\r\n        </md-table-cell>\r\n      </md-table-row>\r\n    </md-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _ from \"lodash\";\r\nexport default {\r\n  name: 'ListeDesRestaurants',\r\n  data: function(){\r\n      return {\r\n            restaurants: [],\r\n            nom: '',\r\n            cuisine: '',\r\n            nombreRestaurantsTotal: 0,\r\n            page: 0,\r\n            pageSize: 10,\r\n            nbrePagesTotal: 0,\r\n            msg: '',\r\n            nomRestoRechercher: ''\r\n        }\r\n    },\r\n        mounted() {\r\n            console.log(\"mounted\")\r\n            this.getRestaurantsFromServer();\r\n        }\r\n        ,\r\n        methods: {\r\n            pagePrecedente() {\r\n                if (this.page == 0) return;\r\n\r\n                this.page--;\r\n                this.getRestaurantsFromServer();\r\n            },\r\n            pageSuivante() {\r\n                if (this.page === this.dernierePage) return;\r\n                this.page++;\r\n                this.getRestaurantsFromServer();\r\n            },\r\n            getRestaurantsFromServer() {\r\n                let url = \"http://localhost:8080/api/restaurants?\";\r\n                url += \"page=\" + this.page;\r\n                url += \"&pagesize=\" + this.pageSize;\r\n                url += \"&name=\" + this.nomRestoRechercher;\r\n\r\n                fetch(url)\r\n                    .then((responseJSON) => {//arow fonction conserve le bon \"this\".\r\n                        responseJSON.json()\r\n                            .then((resJs) => {\r\n                                // Maintenant resJs est un vrai objet JavaScript\r\n                                this.restaurants = resJs.data;\r\n                                console.log(\"Restaurants récupérés\")\r\n                                console.dir(this.restaurants);\r\n                                this.nombreRestaurantsTotal = resJs.count;\r\n                                this.nbrePagesTotal = Math.round(this.nombreRestaurantsTotal / this.pageSize);\r\n                            });\r\n                    })\r\n                    .catch((err) => {\r\n                        console.log(err);\r\n                    });\r\n            },\r\n            chercherResto:\r\n                _.debounce(function () {\r\n                    this.getRestaurantsFromServer();\r\n                }, 1000),\r\n            supprimerRestaurant(r) {\r\n                let url = \"http://localhost:8080/api/restaurants/\" + r._id;\r\n                \r\n                fetch(url, {\r\n                    method: \"DELETE\",\r\n                    \r\n                })\r\n                    .then((responseJSON) => {\r\n                        responseJSON.json()\r\n                            .then((res) => {\r\n                                // Maintenant res est un vrai objet JavaScript\r\n                                console.log(res.msg);\r\n                                this.msg = res.msg;\r\n\r\n                                //On raffraichit la vue\r\n                                this.getRestaurantsFromServer();\r\n                            });\r\n                    })\r\n                    .catch(function (err) {\r\n                        console.log(err);\r\n                    });\r\n            },\r\n            ajouterRestaurant(event) {\r\n                // Récupération du formulaire. Pas besoin de document.querySelector\r\n                // ou document.getElementById puisque c'est le formulaire qui a généré\r\n                // l'événement\r\n                let form = event.target;\r\n\r\n                // Récupération des valeurs des champs du formulaire\r\n                // en prévision d'un envoi multipart en ajax/fetch\r\n                let donneesFormulaire = new FormData(form);\r\n\r\n                let url = \"http://localhost:8080/api/restaurants\";\r\n\r\n                fetch(url, {\r\n                    method: \"POST\",\r\n                    body: donneesFormulaire\r\n                })\r\n                    .then((responseJSON) => {\r\n                        responseJSON.json()\r\n                            .then((res) => {\r\n                                // Maintenant res est un vrai objet JavaScript\r\n                                console.log(res.msg);\r\n                                this.msg = res.msg;\r\n\r\n                                //On raffraichit la vue\r\n                                this.getRestaurantsFromServer();\r\n                            });\r\n                    })\r\n                    .catch(function (err) {\r\n                        console.log(err);\r\n                    });\r\n                this.nom = \"\";\r\n                this.cuisine = \"\";\r\n            },\r\n            getColor(index) {\r\n                return (index % 2) ? 'lightBlue' : 'pink';\r\n            }\r\n        }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\nh1{\r\n    color: blue;\r\n}\r\n</style>\r\n"]}]}